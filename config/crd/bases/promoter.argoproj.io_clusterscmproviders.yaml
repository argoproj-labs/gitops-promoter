---
apiVersion: apiextensions.k8s.io/v1
kind: CustomResourceDefinition
metadata:
  annotations:
    controller-gen.kubebuilder.io/version: v0.19.0
  name: clusterscmproviders.promoter.argoproj.io
spec:
  group: promoter.argoproj.io
  names:
    kind: ClusterScmProvider
    listKind: ClusterScmProviderList
    plural: clusterscmproviders
    singular: clusterscmprovider
  scope: Cluster
  versions:
  - name: v1alpha1
    schema:
      openAPIV3Schema:
        description: ClusterScmProvider is the Schema for the clusterscmproviders
          API.
        properties:
          apiVersion:
            description: |-
              APIVersion defines the versioned schema of this representation of an object.
              Servers should convert recognized schemas to the latest internal value, and
              may reject unrecognized values.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#resources
            type: string
          kind:
            description: |-
              Kind is a string value representing the REST resource this object represents.
              Servers may infer this from the endpoint the client submits requests to.
              Cannot be updated.
              In CamelCase.
              More info: https://git.k8s.io/community/contributors/devel/sig-architecture/api-conventions.md#types-kinds
            type: string
          metadata:
            type: object
          spec:
            description: ScmProviderSpec defines the desired state of ScmProvider
            properties:
              azureDevOps:
                description: AzureDevOps required configuration for Azure DevOps as
                  the SCM provider
                properties:
                  domain:
                    description: |-
                      Domain is the Azure DevOps domain, such as "dev.azure.com". If using the default Azure DevOps domain, leave this field
                      empty.
                    type: string
                    x-kubernetes-validations:
                    - message: Instead of setting the domain to dev.azure.com, leave
                        the field blank
                      rule: self != "dev.azure.com"
                  organization:
                    description: Organization is the Azure DevOps organization name.
                    maxLength: 50
                    minLength: 1
                    pattern: ^[A-Za-z0-9]([A-Za-z0-9-]*[A-Za-z0-9])?$
                    type: string
                  workloadIdentity:
                    description: |-
                      WorkloadIdentity configures workload identity authentication for Azure DevOps.
                      If specified and enabled=true, workload identity will be used instead of PAT authentication.
                      Fields can be omitted to use environment variables (AZURE_TENANT_ID, AZURE_CLIENT_ID, AZURE_FEDERATED_TOKEN_FILE).
                    properties:
                      clientId:
                        description: |-
                          ClientID is the Azure AD application (client) ID.
                          If not specified, the AZURE_CLIENT_ID environment variable will be used.
                        pattern: ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$
                        type: string
                      enabled:
                        description: |-
                          Enabled indicates whether workload identity authentication should be used.
                          When true, workload identity will be attempted even if tenantId/clientId are not specified,
                          using environment variables AZURE_TENANT_ID and AZURE_CLIENT_ID instead.
                        type: boolean
                      serviceAccountTokenPath:
                        default: /var/run/secrets/azure/tokens/azure-identity-token
                        description: |-
                          ServiceAccountTokenPath is the path to the service account token file.
                          This is typically mounted by the workload identity webhook.
                          If not specified, the AZURE_FEDERATED_TOKEN_FILE environment variable will be used,
                          or it will default to "/var/run/secrets/azure/tokens/azure-identity-token".
                        type: string
                      tenantId:
                        description: |-
                          TenantID is the Azure AD tenant ID.
                          If not specified, the AZURE_TENANT_ID environment variable will be used.
                        pattern: ^[0-9a-fA-F]{8}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{4}-[0-9a-fA-F]{12}$
                        type: string
                    required:
                    - enabled
                    type: object
                required:
                - organization
                type: object
              fake:
                description: Fake required configuration for Fake as the SCM provider
                properties:
                  domain:
                    description: Domain is the domain of the fake SCM provider. This
                      is used for testing purposes.
                    type: string
                type: object
              forgejo:
                description: Forgejo required configuration for Forgejo as the SCM
                  provider
                properties:
                  domain:
                    description: |-
                      Domain is the Forgejo domain, such as "codeberg.org" or "forgejo.mycompany.com".
                      There is no default domain since Forgejo is not a service like Gitlab or Github.
                    type: string
                required:
                - domain
                type: object
              github:
                description: GitHub required configuration for GitHub as the SCM provider
                properties:
                  appID:
                    description: AppID is the GitHub App ID.
                    format: int64
                    type: integer
                  domain:
                    description: |-
                      Domain is the GitHub domain, such as "github.mycompany.com". If using the default GitHub domain, leave this field
                      empty.
                    type: string
                    x-kubernetes-validations:
                    - message: Instead of setting the domain to github.com, leave
                        the field blank
                      rule: self != "github.com"
                  installationID:
                    description: |-
                      InstallationID is the GitHub App Installation ID. If you want to use this ScmProvider for multiple
                      GitHub orgs, do not specify this field. The installation ID will be inferred from the repo owner
                      when needed.
                    format: int64
                    minimum: 0
                    type: integer
                required:
                - appID
                type: object
              gitlab:
                description: GitLab required configuration for GitLab as the SCM provider
                properties:
                  domain:
                    description: |-
                      Domain is the GitLab domain, such as "gitlab.mycompany.com". If using the default GitLab domain, leave this field
                      empty.
                    type: string
                type: object
              secretRef:
                description: SecretRef contains the credentials required to auth to
                  a specific provider
                properties:
                  name:
                    default: ""
                    description: |-
                      Name of the referent.
                      This field is effectively required, but due to backwards compatibility is
                      allowed to be empty. Instances of this type with an empty value here are
                      almost certainly wrong.
                      More info: https://kubernetes.io/docs/concepts/overview/working-with-objects/names/#names
                    type: string
                type: object
                x-kubernetes-map-type: atomic
            type: object
          status:
            description: ScmProviderStatus defines the observed state of ScmProvider
            type: object
        type: object
    served: true
    storage: true
    subresources:
      status: {}
