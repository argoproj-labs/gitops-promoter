apiVersion: promoter.argoproj.io/v1alpha1
kind: PromotionStrategy
metadata:
  name: example-promotion-strategy
spec:
  gitRepositoryRef:
    name: example-git-repo
  activeCommitStatuses:
    - key: argocd-app-health
  proposedCommitStatuses:
    - key: security-scan
  environments:
    - branch: environment/dev
    - branch: environment/test
    - branch: environment/prod
      autoMerge: false
      activeCommitStatuses:
      - key: performance-test
      proposedCommitStatuses:
      - key: deployment-freeze
status:
  environments:
  - branch: environment/dev
    commitStatuses:
      - key:
        phase:
        url:
    dry:
      author:
      body:
      commitTime:
      repoURL:
      sha:
      subject:
    hydrated:
      author:
      body:
      commitTime:
      sha:
      subject:
    proposed:
      # same fields as active
    lastHealthyDryShas:
    - sha:
      time:
  - branch: environment/test
    # same fields as dev
  - branch: environment/prod
    # same fields as dev

apiVersion: promoter.argoproj.io/v1alpha1
kind: ChangeTransferPolicy
metadata:
  annotations:
    promoter.argoproj.io/reconcile-at: '2025-06-24T09:45:03.997017-05:00'
  creationTimestamp: '2025-06-17T21:53:49Z'
  generation: 2
  labels:
    promoter.argoproj.io/environment: environments-production
    promoter.argoproj.io/promotion-strategy: argocon-demo
  name: argocon-demo-environments-production-937d31f
  namespace: default
  ownerReferences:
    - apiVersion: promoter.argoproj.io/v1alpha1
      blockOwnerDeletion: true
      controller: true
      kind: PromotionStrategy
      name: argocon-demo
      uid: 60a1f605-2103-4096-9e8e-f6618a359238
  resourceVersion: '6320475'
  uid: f050e9ce-9df0-414d-bf04-82faf34b80b3
spec:
  activeBranch: environments/production
  activeCommitStatuses:
    - key: argocd-health
  autoMerge: true
  gitRepositoryRef:
    name: argocon-demo
  proposedBranch: environments/production-next
  proposedCommitStatuses:
    - key: promoter-previous-environment
status:
  active:
    commitStatuses:
      - key: argocd-health
        phase: success
        url: https://example.com
    dry:
      author: Zach Aller <zach_aller@intuit.com>
      body: 'Signed-off-by: Zach Aller <zach_aller@intuit.com>'
      commitTime: '2025-06-20T19:08:53Z'
      repoURL: https://github.com/zachaller/argocon-gitops-promoter-hydrate-demo
      sha: 2c93f0250b2b9a98e2ae7f772426757ec7acc309
      subject: bump174
    hydrated:
      author: argoproj-promoter[bot]
      body: Promote 2c93f to `environments/production`
      commitTime: '2025-06-20T19:18:21Z'
      sha: 6c06ab1b79991ba72882e59824335a9a76960c36
      subject: 'Merge pull request #754 from zachaller/environments/production-next'
  proposed:
    commitStatuses:
      - key: promoter-previous-environment
        phase: pending
    dry:
      author: Zach Aller <zach_aller@intuit.com>
      body: 'Signed-off-by: Zach Aller <zach_aller@intuit.com>'
      commitTime: '2025-06-20T20:09:20Z'
      repoURL: https://github.com/zachaller/argocon-gitops-promoter-hydrate-demo
      sha: 9dd9f4754eeb6be20a16d8a0d620ed46d7f6be0d
      subject: bump176
    hydrated:
      author: Argo CD
      commitTime: '2025-06-20T20:09:39Z'
      sha: b610f4fb6e36d738cc4261b43089dee3f129cd1b
      subject: '[Argo CD Bot] hydrate 9dd9f4754eeb6be20a16d8a0d620ed46d7f6be0d'
